import{r as c,a as Ee,R as Pe}from"./vendor-b1791c80.js";import{a as Ae}from"./api-b5ee139b.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const d of i)if(d.type==="childList")for(const m of d.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&n(m)}).observe(document,{childList:!0,subtree:!0});function a(i){const d={};return i.integrity&&(d.integrity=i.integrity),i.referrerPolicy&&(d.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?d.credentials="include":i.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function n(i){if(i.ep)return;i.ep=!0;const d=a(i);fetch(i.href,d)}})();var ae={exports:{}},J={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ie=c,Le=Symbol.for("react.element"),ze=Symbol.for("react.fragment"),Re=Object.prototype.hasOwnProperty,Oe=Ie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Fe={key:!0,ref:!0,__self:!0,__source:!0};function ie(s,t,a){var n,i={},d=null,m=null;a!==void 0&&(d=""+a),t.key!==void 0&&(d=""+t.key),t.ref!==void 0&&(m=t.ref);for(n in t)Re.call(t,n)&&!Fe.hasOwnProperty(n)&&(i[n]=t[n]);if(s&&s.defaultProps)for(n in t=s.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:Le,type:s,key:d,ref:m,props:i,_owner:Oe.current}}J.Fragment=ze;J.jsx=ie;J.jsxs=ie;ae.exports=J;var e=ae.exports,W={},te=Ee;W.createRoot=te.createRoot,W.hydrateRoot=te.hydrateRoot;var _e={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const qe=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),De=(s,t)=>{const a=c.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:d=2,absoluteStrokeWidth:m,children:f,...w},l)=>c.createElement("svg",{ref:l,..._e,width:i,height:i,stroke:n,strokeWidth:m?Number(d)*24/Number(i):d,className:`lucide lucide-${qe(s)}`,...w},[...t.map(([h,u])=>c.createElement(h,u)),...(Array.isArray(f)?f:[f])||[]]));return a.displayName=`${s}`,a};var N=De;const le=N("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),oe=N("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),se=N("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]),B=N("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),Ve=N("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),ce=N("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),re=N("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),$e=N("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Be=N("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),ne=N("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]),G=N("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),de=N("Scan",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]),He=N("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),Ue=N("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),Je=N("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),H=N("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),me=N("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),U=N("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),xe=window.location.origin,T=Ae.create({baseURL:xe,timeout:3e4,headers:{"Content-Type":"application/json"}});T.interceptors.response.use(s=>s,s=>{throw console.error("API Error:",s),s.response?s.response.status>=500?new Error("Erreur serveur. Veuillez réessayer plus tard."):s:new Error("Problème de connexion réseau")});const _={saveTicketToHistory(s){try{const t=JSON.parse(localStorage.getItem("ticketHistory")||"[]"),a=t.findIndex(n=>n.id===s.id);return a>=0?t[a]=s:t.push(s),localStorage.setItem("ticketHistory",JSON.stringify(t)),!0}catch(t){return console.error("Erreur sauvegarde historique:",t),!1}},getTicketHistory(){try{return JSON.parse(localStorage.getItem("ticketHistory")||"[]")}catch(s){return console.error("Erreur lecture historique:",s),[]}},updateTicketStatus(s,t){try{const n=JSON.parse(localStorage.getItem("ticketHistory")||"[]").map(i=>i.id===s?{...i,statut:t}:i);return localStorage.setItem("ticketHistory",JSON.stringify(n)),!0}catch(a){return console.error("Erreur mise à jour statut:",a),!1}}},Qe={async getEvents(){try{return(await T.get("/api/events")).data}catch(s){throw console.error("Erreur lors de la récupération des événements:",s),s}}},Ke={async validatePromo(s,t){try{return(await T.post("/api/validate-promo",{code:s,nombreBillets:t})).data}catch(a){throw console.error("Erreur validation code promo:",a),a}}},q={async createTicket(s){try{return(await T.post("/api/tickets",s)).data}catch(t){throw console.error("Erreur création ticket:",t),t}},async validateTicket(s,t){try{return(await T.put(`/api/tickets/${s}/validate`,{action:t})).data}catch(a){throw console.error("Erreur validation ticket:",a),a}},async verifyTicket(s){try{return(await T.post("/api/tickets/verify",s)).data}catch(t){throw console.error("Erreur vérification ticket:",t),t}},async getTicketById(s){try{return(await T.get(`/api/tickets/${s}`)).data}catch(t){throw console.error("Erreur lors de la récupération du ticket:",t),t}}},We={async simulateMobileMoneyPayment(s){try{return(await T.post("/api/mobile-money/simulate",s)).data}catch(t){throw console.error("Erreur simulation Mobile Money:",t),t}},async handleMobileMoneyWebhook(s){try{return(await T.post("/api/webhook/mobile-money",s)).data}catch(t){throw console.error("Erreur webhook Mobile Money:",t),t}}},Ge={async getStats(){try{return(await T.get("/api/admin/stats")).data}catch(s){throw console.error("Erreur récupération stats:",s),s}}},Xe={async testConnection(){try{return{success:!0,data:(await T.get("/api/events")).data}}catch(s){return{success:!1,error:s.message}}},getBaseURL(){return xe}},Ye=({onBack:s,isOnline:t=!0,apiWorking:a=!0})=>{var L,g,z,b;const[n,i]=c.useState({totalTickets:{count:0},pendingTickets:{count:0},totalRevenue:{total:0},ticketsPending:[],ticketsRecent:[]}),[d,m]=c.useState(!0),[f,w]=c.useState(""),[l,h]=c.useState(""),[u,k]=c.useState(null);c.useEffect(()=>{if(!(localStorage.getItem("adminAuthenticated")==="true")){s&&s();return}},[s]);const E=()=>{localStorage.removeItem("adminAuthenticated"),s&&s()},P=async()=>{m(!0),w("");try{if(t&&a){const r=await Ge.getStats();console.log("API Stats data:",r),i({totalTickets:r.totalTickets||{count:0},pendingTickets:r.pendingTickets||{count:0},totalRevenue:r.totalRevenue||{total:0},ticketsPending:Array.isArray(r.ticketsPending)?r.ticketsPending:[],ticketsRecent:Array.isArray(r.ticketsRecent)?r.ticketsRecent:[]})}else{const r=JSON.parse(localStorage.getItem("tickets")||"[]"),x=JSON.parse(localStorage.getItem("transactions")||"[]"),S=r.filter(C=>C.statut==="confirmed"),R=r.filter(C=>C.statut==="pending"),O=x.filter(C=>C.statut==="completed");i({totalTickets:{count:S.length},pendingTickets:{count:R.length},totalRevenue:{total:O.reduce((C,F)=>C+(F.montant||0),0)},ticketsPending:R.slice(-10),ticketsRecent:S.slice(-10).reverse()})}}catch(r){console.error("Erreur chargement stats:",r),w("Impossible de charger les statistiques"),i({totalTickets:{count:0},pendingTickets:{count:0},totalRevenue:{total:0},ticketsPending:[],ticketsRecent:[]})}finally{m(!1)}},v=async(r,x)=>{try{if(t&&a)await q.validateTicket(r,x);else{const O=JSON.parse(localStorage.getItem("tickets")||"[]").map(M=>M.id===r?{...M,statut:x==="approve"?"confirmed":"rejected",dateValidation:new Date().toISOString()}:M);localStorage.setItem("tickets",JSON.stringify(O));const F=JSON.parse(localStorage.getItem("transactions")||"[]").map(M=>M.ticketId===r?{...M,statut:x==="approve"?"completed":"failed"}:M);localStorage.setItem("transactions",JSON.stringify(F))}await P(),alert(`✅ Ticket ${x==="approve"?"approuvé":"rejeté"} avec succès`)}catch(S){console.error("Erreur validation ticket:",S),w(`Erreur lors de la validation: ${S.message}`)}},Q=async()=>{if(!l.trim()){w("Veuillez entrer un ID ou QR code");return}k(null),w("");try{if(t&&a){const r=await q.verifyTicket({ticketId:l});k(r)}else{const x=JSON.parse(localStorage.getItem("tickets")||"[]").find(S=>S.id===l||S.qrCode===l||S.codeUnique===l);x?x.statut==="confirmed"?k({valid:!0,ticket:{id:x.id,nombreBillets:x.nombreBillets,prixTotal:x.prixTotal,typePaiement:x.typePaiement},message:`Ticket valide - ${x.nombreBillets} personne(s) - Accès autorisé`}):k({valid:!1,ticket:x,message:`Ticket non confirmé - Statut: ${x.statut}`}):k({valid:!1,message:"Ticket introuvable"})}}catch(r){console.error("Erreur vérification ticket:",r),w(`Erreur vérification: ${r.message}`)}h("")};return c.useEffect(()=>{P()},[t,a]),d?e.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(G,{className:"animate-spin mx-auto mb-4 text-blue-600",size:48}),e.jsx("p",{children:"Chargement du dashboard..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-100 p-4",children:[(!t||!a)&&e.jsx("div",{className:`fixed top-0 left-0 right-0 z-50 p-2 text-center text-sm text-white ${t?"bg-orange-500":"bg-red-500"}`,children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[t?e.jsx(le,{size:16}):e.jsx(H,{size:16}),e.jsxs("span",{children:[t?"API non disponible":"Mode hors-ligne"," - Données locales uniquement"]})]})}),e.jsxs("div",{className:"max-w-6xl mx-auto mt-8",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Admin Dashboard"}),e.jsx("div",{className:"flex items-center space-x-2 mt-2",children:t&&a?e.jsxs(e.Fragment,{children:[e.jsx(me,{size:16,className:"text-green-600"}),e.jsx("span",{className:"text-sm text-green-600",children:"En ligne"})]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{size:16,className:"text-orange-600"}),e.jsx("span",{className:"text-sm text-orange-600",children:"Hors-ligne"})]})})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:P,className:"flex items-center space-x-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:[e.jsx(G,{size:16}),e.jsx("span",{children:"Actualiser"})]}),e.jsx("button",{onClick:s,className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600",children:"Retour Client"}),e.jsx("button",{onClick:E,className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600",children:"Déconnexion"})]})]})}),f&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:e.jsx("p",{className:"text-red-600",children:f})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Tickets confirmés"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:((L=n.totalTickets)==null?void 0:L.count)||0})]}),e.jsx(Je,{className:"text-blue-600",size:32})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Revenus totaux"}),e.jsxs("p",{className:"text-3xl font-bold text-green-600",children:[(((g=n.totalRevenue)==null?void 0:g.total)||0).toLocaleString()," F"]})]}),e.jsx(Ue,{className:"text-green-600",size:32})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"En attente"}),e.jsx("p",{className:"text-3xl font-bold text-orange-600",children:((z=n.pendingTickets)==null?void 0:z.count)||0})]}),e.jsx(ce,{className:"text-orange-600",size:32})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"🎫 Contrôle d'accès"}),e.jsxs("div",{className:"flex space-x-4 mb-4",children:[e.jsx("input",{type:"text",value:l,onChange:r=>h(r.target.value),placeholder:"Scanner ou saisir l'ID du ticket...",className:"flex-1 p-3 border border-gray-300 rounded-lg",onKeyPress:r=>r.key==="Enter"&&Q()}),e.jsxs("button",{onClick:Q,className:"px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 flex items-center space-x-2",children:[e.jsx(de,{size:20}),e.jsx("span",{children:"Vérifier"})]})]}),u&&e.jsxs("div",{className:`p-4 rounded-lg border ${u.valid?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[u.valid?e.jsx(B,{className:"text-green-600",size:20}):e.jsx(U,{className:"text-red-600",size:20}),e.jsx("span",{className:`font-semibold ${u.valid?"text-green-600":"text-red-600"}`,children:u.message})]}),u.valid&&u.ticket&&e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("p",{children:["• ID: ",u.ticket.id]}),e.jsxs("p",{children:["• Personnes: ",u.ticket.nombreBillets]}),e.jsxs("p",{children:["• Montant:"," ",(b=u.ticket.prixTotal)==null?void 0:b.toLocaleString()," FCFA"]}),e.jsxs("p",{children:["• Paiement: ",u.ticket.typePaiement]})]})]})]}),Array.isArray(n.ticketsPending)&&n.ticketsPending.length>0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-6",children:[e.jsxs("h2",{className:"text-xl font-bold mb-4",children:["⏳ Tickets en attente (",n.ticketsPending.length,")"]}),e.jsx("div",{className:"space-y-4",children:n.ticketsPending.map(r=>{var x;return e.jsx("div",{className:"border border-orange-200 rounded-lg p-4 bg-orange-50",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-mono text-sm text-gray-600",children:r.id}),e.jsxs("p",{className:"font-semibold",children:[r.nombre_billets||r.nombreBillets," ","billet(s) -"," ",(x=r.prix_total||r.prixTotal)==null?void 0:x.toLocaleString()," ","FCFA"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Paiement:"," ",r.type_paiement||r.typePaiement,(r.code_promo||r.codePromo)&&` • Code: ${r.code_promo||r.codePromo}`]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Créé:"," ",new Date(r.date_creation||r.dateCreation).toLocaleString("fr-FR")]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>v(r.id,"approve"),className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 flex items-center space-x-1",children:[e.jsx(B,{size:16}),e.jsx("span",{children:"Approuver"})]}),e.jsxs("button",{onClick:()=>v(r.id,"reject"),className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 flex items-center space-x-1",children:[e.jsx(U,{size:16}),e.jsx("span",{children:"Rejeter"})]})]})]})},r.id)})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"✅ Tickets récents confirmés"}),!Array.isArray(n.ticketsRecent)||n.ticketsRecent.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucun ticket confirmé"}):e.jsx("div",{className:"space-y-2",children:n.ticketsRecent.map(r=>{var x;return e.jsx("div",{className:"border border-green-200 rounded-lg p-3 bg-green-50",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-mono text-sm text-gray-600",children:r.id}),e.jsxs("p",{className:"text-sm",children:[r.nombre_billets||r.nombreBillets," ","billet(s) -"," ",(x=r.prix_total||r.prixTotal)==null?void 0:x.toLocaleString()," ","FCFA"]})]}),e.jsx("div",{className:"text-xs text-gray-500",children:r.date_validation||r.dateValidation?new Date(r.date_validation||r.dateValidation).toLocaleString("fr-FR"):"Date non disponible"})]})},r.id)})})]})]})]})},Ze=({onBack:s})=>{const[t,a]=c.useState([]),[n,i]=c.useState(!0),d=()=>{const l=_.getTicketHistory();l.forEach(u=>{q.getTicketById(u.id).then(k=>{const E={...u,...k};_.saveTicketToHistory(E)})});const h=_.getTicketHistory();a(h.sort((u,k)=>new Date(k.dateCreation)-new Date(u.dateCreation))),i(!1),console.log("history",l),console.log("updatedHistory",h)};c.useEffect(()=>{d()},[]);const m=l=>{console.log("Télécharger ticket:",l),alert("Fonctionnalité de téléchargement PDF à implémenter")},f=l=>{switch(l){case"confirmed":return e.jsx(B,{className:"text-green-600",size:16});case"rejected":return e.jsx(U,{className:"text-red-600",size:16});default:return e.jsx(ce,{className:"text-orange-600",size:16})}},w=l=>{switch(l){case"confirmed":return"Confirmé";case"rejected":return"Rejeté";default:return"En attente"}};return n?e.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:e.jsx(G,{className:"animate-spin text-blue-600",size:32})}):e.jsx("div",{className:"min-h-screen bg-gray-100 p-4",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Mes Tickets"}),e.jsx("button",{onClick:s,className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600",children:"Retour"})]}),t.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"Aucun ticket dans votre historique"})}):e.jsx("div",{className:"space-y-4",children:t.map(l=>{var h;return e.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[f(l.statut),e.jsx("span",{className:`font-semibold ${l.statut==="confirmed"?"text-green-600":l.statut==="rejected"?"text-red-600":"text-orange-600"}`,children:w(l.statut)})]}),e.jsxs("p",{className:"font-mono text-sm text-gray-600 mb-1",children:["ID: ",l.id]}),e.jsxs("p",{className:"font-semibold",children:[l.nombreBillets," billet(s) -"," ",(h=l.prixTotal)==null?void 0:h.toLocaleString()," FCFA"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Paiement: ",l.typePaiement,l.codePromo&&` • Code: ${l.codePromo}`]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Créé le:"," ",new Date(l.dateCreation).toLocaleString("fr-FR")]})]}),e.jsx("div",{className:"flex space-x-2",children:l.statut==="confirmed"&&e.jsx("button",{onClick:()=>m(l),className:"p-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",title:"Télécharger PDF",children:e.jsx($e,{size:16})})})]})},l.id)})})]})})})},et=({onBack:s})=>{var w;const[t,a]=c.useState(""),[n,i]=c.useState(null),[d,m]=c.useState(!1),f=async()=>{if(t.trim()){m(!0),i(null);try{const l=await q.verifyTicket({ticketId:t});i(l)}catch(l){i({valid:!1,message:"Erreur de vérification: "+l.message})}finally{m(!1)}}};return e.jsx("div",{className:"min-h-screen bg-gray-100 p-4",children:e.jsx("div",{className:"max-w-md mx-auto",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h1",{className:"text-xl font-bold",children:"Contrôle d'accès"}),e.jsxs("button",{onClick:s,className:"flex items-center space-x-1 text-blue-500 hover:text-blue-600",children:[e.jsx(oe,{size:16}),e.jsx("span",{children:"Retour"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Scanner un QR code ou saisir l'ID"}),e.jsx("input",{type:"text",value:t,onChange:l=>a(l.target.value),placeholder:"Scanner ou coller le code...",className:"w-full p-3 border border-gray-300 rounded-lg",onKeyPress:l=>l.key==="Enter"&&f()})]}),e.jsxs("button",{onClick:f,disabled:d||!t.trim(),className:"w-full bg-blue-500 text-white py-3 rounded-lg font-semibold hover:bg-blue-600 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:[d?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):e.jsx(de,{size:20}),e.jsx("span",{children:d?"Vérification...":"Vérifier le ticket"})]}),n&&e.jsxs("div",{className:`p-4 rounded-lg border ${n.valid?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[n.valid?e.jsx(B,{className:"text-green-600",size:20}):e.jsx(U,{className:"text-red-600",size:20}),e.jsx("span",{className:`font-semibold ${n.valid?"text-green-600":"text-red-600"}`,children:n.message})]}),n.valid&&n.ticket&&e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("p",{children:["• ID: ",n.ticket.id]}),e.jsxs("p",{children:["• Personnes: ",n.ticket.nombreBillets]}),e.jsxs("p",{children:["• Montant:"," ",(w=n.ticket.prixTotal)==null?void 0:w.toLocaleString()," ","FCFA"]}),e.jsxs("p",{children:["• Paiement: ",n.ticket.typePaiement]})]})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Instructions:"}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:"• Scanner le QR code du ticket"}),e.jsx("li",{children:"• Ou saisir manuellement l'ID du ticket"}),e.jsx("li",{children:'• Appuyer sur Entrée ou le bouton "Vérifier"'}),e.jsx("li",{children:"• Autoriser l'accès si le ticket est valide"})]})]})]})})})},tt=({onLogin:s,onBack:t})=>{const[a,n]=c.useState(""),[i,d]=c.useState(""),[m,f]=c.useState(""),w=l=>{l.preventDefault(),a==="admin"&&i==="admin123"?(localStorage.setItem("adminAuthenticated","true"),s()):f("Identifiants incorrects")};return e.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Connexion Admin"}),e.jsxs("button",{onClick:t,className:"flex items-center space-x-1 text-blue-500 hover:text-blue-600",children:[e.jsx(oe,{size:16}),e.jsx("span",{children:"Retour"})]})]}),m&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-600 text-sm",children:m})}),e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Nom d'utilisateur"}),e.jsx("input",{type:"text",value:a,onChange:l=>n(l.target.value),className:"w-full p-3 border border-gray-300 rounded-lg",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Mot de passe"}),e.jsx("input",{type:"password",value:i,onChange:l=>d(l.target.value),className:"w-full p-3 border border-gray-300 rounded-lg",required:!0})]}),e.jsx("button",{type:"submit",className:"w-full bg-blue-500 text-white py-3 rounded-lg font-semibold hover:bg-blue-600",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(Be,{size:16}),e.jsx("span",{children:"Se connecter"})]})})]})]})})},st=(s,t)=>{const[a,n]=c.useState(()=>{try{const d=localStorage.getItem(s);return d?JSON.parse(d):t}catch{return t}});return[a,d=>{n(d);try{localStorage.setItem(s,JSON.stringify(d))}catch(m){console.error("Erreur localStorage:",m)}}]},rt=()=>{const[s,t]=c.useState(navigator.onLine);return c.useEffect(()=>{const a=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",a),window.addEventListener("offline",n),()=>{window.removeEventListener("online",a),window.removeEventListener("offline",n)}},[]),s},A=({isOnline:s,apiWorking:t})=>s&&t?null:e.jsx("div",{className:`fixed top-0 left-0 right-0 z-50 p-2 text-center text-sm text-white ${s?"bg-orange-500":"bg-red-500"}`,children:s?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(le,{size:16}),e.jsx("span",{children:"Problème de connexion API - Utilisation du cache local"})]}):e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(H,{size:16}),e.jsx("span",{children:"Mode hors-ligne - Fonctionnalités limitées"})]})});function nt(){const[s,t]=c.useState("qr-scan"),[a,n]=c.useState(1),[i,d]=c.useState(""),[m,f]=c.useState(0),[w,l]=c.useState(""),[h,u]=c.useState(null),[k,E]=c.useState(!1),[P,v]=c.useState(""),[Q,L]=c.useState([]),[g,z]=c.useState(null),b=rt(),[r,x]=c.useState(!0),[S,R]=c.useState(!1),[O,C]=c.useState(!1),[F,M]=c.useState(!1),[ue,X]=c.useState(!1),[he,ge]=st("tickets",[]),pe={NOEL2024:{reduction:10,actif:!0},FAMILLE:{reduction:15,minBillets:4,actif:!0},EARLY:{reduction:20,actif:!0}};c.useEffect(()=>{const o=localStorage.getItem("adminAuthenticated")==="true";R(o)},[]),c.useEffect(()=>{fe(),be()},[]);const be=async()=>{try{const o=await Xe.testConnection();x(o.success),o.success||console.warn("API non accessible, utilisation du cache local")}catch(o){x(!1),console.error("Test API failed:",o)}},fe=async()=>{try{if(b&&r){const o=await Qe.getEvents();L(o),z(o[0]||null),localStorage.setItem("cached_events",JSON.stringify(o))}else{const o=JSON.parse(localStorage.getItem("cached_events")||"[]");if(o.length>0)L(o),z(o[0]);else{const j={id:1,nom:"Village de Noël KIDS EVENTS",prix_unitaire:5e3,stock_restant:200,date_event:"2024-12-25"};L([j]),z(j)}}}catch(o){console.error("Erreur chargement événements:",o),v("Erreur lors du chargement des événements")}},je=async()=>{var o,j;if(!i.trim()){v("Veuillez entrer un code promo");return}E(!0),v("");try{if(b&&r){const p=await Ke.validatePromo(i.toUpperCase(),a);f(p.pourcentage),alert(`✅ Code appliqué ! Réduction de ${p.pourcentage}%`)}else{const p=pe[i.toUpperCase()];if(p&&p.actif){if(p.minBillets&&a<p.minBillets){v(`Ce code nécessite minimum ${p.minBillets} billets`);return}f(p.reduction),alert(`✅ Code appliqué ! Réduction de ${p.reduction}%`)}else v("Code promo invalide"),d(""),f(0)}}catch(p){console.error("Erreur validation promo:",p),v(((j=(o=p.response)==null?void 0:o.data)==null?void 0:j.error)||"Erreur validation code promo"),d(""),f(0)}finally{E(!1)}},I=()=>g?(g.prix_unitaire||5e3)*a*(100-m)/100:0,D=async(o,j={})=>{var V,ee;if(!g)throw new Error("Aucun événement sélectionné");const p={eventId:g.id,nombreBillets:a,typePaiement:o,codePromo:i||null,prixUnitaire:g.prix_unitaire||5e3,...j};try{if(b&&r){const y=await q.createTicket(p),$={id:y.ticketId,codeUnique:y.codeUnique,qrCode:y.qrCode,prixTotal:y.prixTotal,reduction:y.reduction,statut:y.statut,eventId:g.id,nombreBillets:a,typePaiement:o,codePromo:i,dateCreation:new Date().toISOString()},Me=JSON.parse(localStorage.getItem("tickets")||"[]");return localStorage.setItem("tickets",JSON.stringify([...Me,$])),_.saveTicketToHistory($),{id:y.ticketId,codeUnique:y.codeUnique,qrCode:y.qrCode,prixTotal:y.prixTotal,reduction:y.reduction,statut:y.statut,eventId:g.id,nombreBillets:a,typePaiement:o,codePromo:i,dateCreation:new Date().toISOString()}}else{const y={id:`OFFLINE_TICKET_${Date.now()}`,codeUnique:`${g.id}-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,qrCode:`QR_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,prixTotal:I(),reduction:m,statut:o==="mobile-money"?"confirmed":"pending",eventId:g.id,nombreBillets:a,typePaiement:o,codePromo:i,dateCreation:new Date().toISOString(),isOffline:!0},$=[...he,y];return ge($),_.saveTicketToHistory(y),y}}catch(y){throw console.error("Erreur génération ticket:",y),new Error(((ee=(V=y.response)==null?void 0:V.data)==null?void 0:ee.error)||"Erreur lors de la génération du ticket")}},K=async o=>{E(!0),v("");try{if(b&&r){const j={provider:o,montant:I(),numero:`${o==="MTN"?"70":o==="MOOV"?"96":"90"}123456`},p=await We.simulateMobileMoneyPayment(j);if(p.success){const V=await D("mobile-money",{mobileMoneyProvider:o,transactionId:p.transactionId});u(V),t("ticket-generated")}else throw new Error(p.message||"Échec du paiement")}else{setTimeout(async()=>{try{const j=await D("mobile-money");u(j),t("ticket-generated")}catch(j){v(j.message)}finally{E(!1)}},2e3);return}}catch(j){console.error("Erreur paiement Mobile Money:",j),v(j.message||"Erreur lors du paiement")}finally{E(!1)}},Y=()=>{n(1),d(""),f(0),u(null),v(""),l("")},Z=()=>e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-red-50 to-green-50 p-4",children:[e.jsx(A,{isOnline:b,apiWorking:r}),e.jsx("div",{className:"max-w-md mx-auto mt-8",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 text-center",children:[e.jsx("div",{className:"bg-red-500 text-white rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4",children:e.jsx(ne,{size:32})}),e.jsx("h1",{className:"text-xl font-bold text-gray-800 mb-2",children:"Village de Noël"}),e.jsx("h2",{className:"text-lg text-gray-600 mb-6",children:"KIDS EVENTS"}),e.jsxs("div",{className:`inline-flex items-center space-x-2 px-3 py-1 rounded-full text-xs mb-4 ${b&&r?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"}`,children:[b&&r?e.jsx(me,{size:12}):e.jsx(H,{size:12}),e.jsx("span",{children:b&&r?"En ligne":"Mode hors-ligne"})]}),O?e.jsx(tt,{onLogin:()=>{R(!0),C(!1),t("admin")},onBack:()=>C(!1)}):F?e.jsx(Ze,{onBack:()=>M(!1)}):ue?e.jsx(et,{onBack:()=>X(!1)}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>t("ticket-selection"),className:"w-full bg-green-500 text-white py-3 rounded-lg font-semibold hover:bg-green-600 transition-colors mb-4",children:"Acheter des billets"}),e.jsx("button",{onClick:()=>M(!0),className:"w-full bg-purple-500 text-white py-2 rounded-lg font-semibold hover:bg-purple-600 transition-colors",children:"Mes Tickets"}),e.jsx("button",{onClick:()=>X(!0),className:"w-full bg-orange-500 text-white py-2 rounded-lg font-semibold hover:bg-orange-600 transition-colors",children:"Contrôle d'accès"}),S?e.jsx("button",{onClick:()=>t("admin"),className:"w-full bg-blue-500 text-white py-2 rounded-lg font-semibold hover:bg-blue-600 transition-colors",children:"Accès Admin"}):e.jsx("button",{onClick:()=>C(!0),className:"w-full bg-blue-500 text-white py-2 rounded-lg font-semibold hover:bg-blue-600 transition-colors",children:"Connexion Admin"})]})]})})]}),ye=()=>{var o,j;return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-green-50 to-red-50 p-4",children:[e.jsx(A,{isOnline:b,apiWorking:r}),e.jsx("div",{className:"max-w-md mx-auto mt-8",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-6 text-center",children:"Sélection des billets"}),g&&e.jsxs("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-blue-900",children:g.nom}),e.jsxs("p",{className:"text-sm text-blue-700",children:["Prix: ",(o=g.prix_unitaire)==null?void 0:o.toLocaleString()," FCFA"]}),g.stock_restant&&e.jsxs("p",{className:"text-xs text-blue-600",children:["Stock disponible: ",g.stock_restant]})]}),P&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-600 text-sm",children:P})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Nombre de billets"}),e.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[e.jsx("button",{onClick:()=>{n(Math.max(1,a-1)),v("")},className:"w-12 h-12 bg-red-500 text-white rounded-full flex items-center justify-center text-xl font-bold",children:"-"}),e.jsx("span",{className:"text-2xl font-bold w-8 text-center",children:a}),e.jsx("button",{onClick:()=>{n(a+1),v("")},className:"w-12 h-12 bg-green-500 text-white rounded-full flex items-center justify-center text-xl font-bold",children:"+"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Code de réduction (optionnel)"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",value:i,onChange:p=>{d(p.target.value.toUpperCase()),v("")},placeholder:"NOEL2024",className:"flex-1 p-3 border border-gray-300 rounded-lg",disabled:k}),e.jsx("button",{onClick:je,disabled:k||!i.trim(),className:"px-4 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-400 disabled:cursor-not-allowed",children:k?"...":"Valider"})]}),m>0&&e.jsxs("p",{className:"text-green-600 text-sm mt-2",children:["✅ Réduction de ",m,"% appliquée"]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{children:"Prix unitaire:"}),e.jsxs("span",{children:[((j=g==null?void 0:g.prix_unitaire)==null?void 0:j.toLocaleString())||"5,000"," FCFA"]})]}),e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{children:"Quantité:"}),e.jsx("span",{children:a})]}),m>0&&e.jsxs("div",{className:"flex justify-between mb-2 text-green-600",children:[e.jsxs("span",{children:["Réduction (",m,"%):"]}),e.jsxs("span",{children:["-",(((g==null?void 0:g.prix_unitaire)||5e3)*a*m/100).toLocaleString()," ","FCFA"]})]}),e.jsx("hr",{className:"my-2"}),e.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{children:[I().toLocaleString()," FCFA"]})]})]}),e.jsx("button",{onClick:()=>t("payment-selection"),className:"w-full bg-green-500 text-white py-3 rounded-lg font-semibold hover:bg-green-600 transition-colors",children:"Continuer vers le paiement"})]})})]})},ve=()=>e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-red-50 to-green-50 p-4",children:[e.jsx(A,{isOnline:b,apiWorking:r}),e.jsx("div",{className:"max-w-md mx-auto mt-8",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-6 text-center",children:"Mode de paiement"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("button",{onClick:()=>{l("cash"),t("cash-payment")},className:"w-full p-4 border-2 border-gray-200 rounded-lg hover:border-green-500 hover:bg-green-50 flex items-center space-x-4",children:[e.jsx(se,{className:"text-green-600",size:24}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-semibold",children:"Espèces (Cash)"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Paiement à la caisse"})]})]}),e.jsxs("button",{onClick:()=>{l("card"),t("card-payment")},className:"w-full p-4 border-2 border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 flex items-center space-x-4",children:[e.jsx(re,{className:"text-blue-600",size:24}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-semibold",children:"Carte bancaire"}),e.jsx("div",{className:"text-sm text-gray-500",children:"TPE à l'accueil"})]})]}),e.jsxs("button",{onClick:()=>{l("mobile-money"),t("mobile-money-selection")},className:"w-full p-4 border-2 border-gray-200 rounded-lg hover:border-orange-500 hover:bg-orange-50 flex items-center space-x-4",children:[e.jsx(He,{className:"text-orange-600",size:24}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-semibold",children:"Mobile Money"}),e.jsx("div",{className:"text-sm text-gray-500",children:"MTN, Moov, Togocom"})]})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium",children:"Récapitulatif:"}),e.jsxs("div",{className:"text-lg font-bold",children:[I().toLocaleString()," FCFA"]})]})]})})]}),Ne=()=>e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-orange-50 to-red-50 p-4",children:[e.jsx(A,{isOnline:b,apiWorking:r}),e.jsx("div",{className:"max-w-md mx-auto mt-8",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-6 text-center",children:"Mobile Money"}),P&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-600 text-sm",children:P})}),k?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto mb-4"}),e.jsx("p",{children:"Traitement du paiement en cours..."}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Veuillez patienter"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{onClick:()=>K("MTN"),className:"p-4 border-2 border-gray-200 rounded-lg hover:border-yellow-500 cursor-pointer transition-colors",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-yellow-500 rounded-full flex items-center justify-center text-white font-bold",children:"MTN"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"MTN Mobile Money"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Composez *133#"})]})]})}),e.jsx("div",{onClick:()=>K("MOOV"),className:"p-4 border-2 border-gray-200 rounded-lg hover:border-blue-500 cursor-pointer transition-colors",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold",children:"MOOV"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Moov Money"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Composez *555#"})]})]})}),e.jsx("div",{onClick:()=>K("TOGOCOM"),className:"p-4 border-2 border-gray-200 rounded-lg hover:border-green-500 cursor-pointer transition-colors",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center text-white font-bold",children:"TCEL"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Togocom"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Composez *890#"})]})]})})]}),e.jsxs("div",{className:"mt-6 p-4 bg-orange-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"Montant à payer:"}),e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[I().toLocaleString()," FCFA"]})]}),!b&&e.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsx("p",{className:"text-yellow-800 text-sm",children:"⚠️ Mode hors-ligne: Le ticket sera généré localement et devra être synchronisé plus tard."})})]})})]}),we=()=>e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-green-50 to-red-50 p-4",children:[e.jsx(A,{isOnline:b,apiWorking:r}),e.jsx("div",{className:"max-w-md mx-auto mt-8",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 text-center",children:[e.jsx(se,{size:48,className:"mx-auto text-green-600 mb-4"}),e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Paiement en espèces"}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg mb-6",children:[e.jsx("div",{className:"text-lg font-semibold",children:"Montant à payer:"}),e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[I().toLocaleString()," FCFA"]})]}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Présentez-vous à la caisse avec le montant exact. Votre ticket sera généré après validation du paiement par notre équipe."}),e.jsx("button",{onClick:async()=>{try{const o=await D("cash");u(o),t("ticket-pending")}catch(o){v(o.message)}},className:"w-full bg-green-500 text-white py-3 rounded-lg font-semibold hover:bg-green-600",children:"Confirmer - Aller à la caisse"})]})})]}),ke=()=>e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-blue-50 to-red-50 p-4",children:[e.jsx(A,{isOnline:b,apiWorking:r}),e.jsx("div",{className:"max-w-md mx-auto mt-8",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 text-center",children:[e.jsx(re,{size:48,className:"mx-auto text-blue-600 mb-4"}),e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Paiement par carte"}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-6",children:[e.jsx("div",{className:"text-lg font-semibold",children:"Montant à payer:"}),e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[I().toLocaleString()," FCFA"]})]}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Dirigez-vous vers le TPE à l'accueil pour effectuer votre paiement par carte bancaire. Votre ticket sera généré après validation."}),e.jsx("button",{onClick:async()=>{try{const o=await D("card");u(o),t("ticket-pending")}catch(o){v(o.message)}},className:"w-full bg-blue-500 text-white py-3 rounded-lg font-semibold hover:bg-blue-600",children:"Confirmer - Aller au TPE"})]})})]}),Se=()=>e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-green-50 to-red-50 p-4",children:[e.jsx(A,{isOnline:b,apiWorking:r}),e.jsx("div",{className:"max-w-md mx-auto mt-8",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 text-center",children:[e.jsx("div",{className:"bg-green-500 text-white rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4",children:e.jsx(Ve,{size:32})}),e.jsx("h2",{className:"text-xl font-bold mb-4 text-green-600",children:"Paiement confirmé !"}),h&&e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[e.jsxs("div",{className:"border-2 border-gray-300 rounded-lg p-4 mb-4",children:[e.jsx(ne,{size:64,className:"mx-auto mb-2"}),e.jsx("p",{className:"text-xs text-gray-500 font-mono break-all",children:h.qrCode})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"ID Ticket:"}),e.jsx("span",{className:"font-mono text-xs",children:h.id})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Nombre de billets:"}),e.jsx("span",{children:h.nombreBillets})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Prix total:"}),e.jsxs("span",{className:"font-semibold",children:[h.prixTotal.toLocaleString()," FCFA"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Mode de paiement:"}),e.jsx("span",{className:"capitalize",children:h.typePaiement.replace("-"," ")})]}),h.isOffline&&e.jsx("div",{className:"text-orange-600 text-xs mt-2",children:"⚠️ Ticket créé hors-ligne - Synchronisation requise"})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Présentez ce QR code à l'entrée de l'événement"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>{t("qr-scan"),Y()},className:"w-full bg-green-500 text-white py-3 rounded-lg font-semibold hover:bg-green-600",children:"Nouveau ticket"}),e.jsx("button",{onClick:()=>t("admin"),className:"w-full bg-blue-500 text-white py-3 rounded-lg font-semibold hover:bg-blue-600",children:"Accès Admin"})]})]})})]}),Ce=()=>e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-orange-50 to-red-50 p-4",children:[e.jsx(A,{isOnline:b,apiWorking:r}),e.jsx("div",{className:"max-w-md mx-auto mt-8",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 text-center",children:[e.jsx("div",{className:"bg-orange-500 text-white rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-white border-t-transparent"})}),e.jsx("h2",{className:"text-xl font-bold mb-4 text-orange-600",children:"Paiement en attente"}),h&&e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"Votre ticket:"}),e.jsx("div",{className:"font-mono text-sm bg-white p-2 rounded break-all",children:h.id}),e.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[h.nombreBillets," billet(s) -"," ",h.prixTotal.toLocaleString()," FCFA"]}),h.isOffline&&e.jsx("div",{className:"text-orange-600 text-xs mt-2",children:"⚠️ Ticket créé hors-ligne"})]}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Votre demande de ticket est enregistrée. Effectuez votre paiement et attendez la validation de notre équipe."}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>t("admin"),className:"w-full bg-orange-500 text-white py-3 rounded-lg font-semibold hover:bg-orange-600",children:"Vérifier le statut (Admin)"}),e.jsx("button",{onClick:()=>{t("qr-scan"),Y()},className:"w-full bg-gray-500 text-white py-3 rounded-lg font-semibold hover:bg-gray-600",children:"Nouveau ticket"})]})]})})]}),Te=()=>{switch(s){case"qr-scan":return e.jsx(Z,{});case"ticket-selection":return e.jsx(ye,{});case"payment-selection":return e.jsx(ve,{});case"cash-payment":return e.jsx(we,{});case"card-payment":return e.jsx(ke,{});case"mobile-money-selection":return e.jsx(Ne,{});case"ticket-generated":return e.jsx(Se,{});case"ticket-pending":return e.jsx(Ce,{});case"admin":return e.jsx(Ye,{onBack:()=>t("qr-scan"),isOnline:b,apiWorking:r});default:return e.jsx(Z,{})}};return e.jsx("div",{className:"font-sans",children:Te()})}W.createRoot(document.getElementById("root")).render(e.jsx(Pe.StrictMode,{children:e.jsx(nt,{})}));
//# sourceMappingURL=index-1791cf25.js.map
